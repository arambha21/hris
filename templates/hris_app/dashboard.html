{% extends 'base.html' %}

{% block content %}
<h1 class="mb-4">Dashboard</h1>

<div class="row">
    <!-- Key Metrics -->
    <div class="col-md-4 mb-4">
        <div class="card">
            <div class="card-header">Key Metrics</div>
            <div class="card-body">
                <p>Total Employees: {{ total_employees }}</p>
                <p>Total Departments: {{ total_departments }}</p>
                <p>Pending Leave Requests: {{ pending_leave_requests }}</p>
                <p>Upcoming Trainings: {{ upcoming_trainings }}</p>
            </div>
        </div>
    </div>

    <!-- Department-wise Employee Count -->
    <div class="col-md-4 mb-4">
        <div class="card">
            <div class="card-header">Department-wise Employee Count</div>
            <div class="card-body">
                <ul class="list-unstyled">
                    {% for dept in department_employee_count %}
                    <li>{{ dept.name }}: {{ dept.employee_count }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <!-- Recent Reports -->
    <div class="col-md-4 mb-4">
        <div class="card">
            <div class="card-header">Recent Reports</div>
            <div class="card-body">
                <ul class="list-unstyled">
                    {% for report in recent_reports %}
                    <li>
                        <a href="{% url 'report_detail' report.pk %}">{{ report.title }}</a>
                        <small class="text-muted d-block">{{ report.report_type }} - {{ report.created_at|date:"F d, Y" }}</small>
                    </li>
                    {% empty %}
                    <li>No recent reports.</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <!-- Recent Leave Requests -->
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header">Recent Leave Requests</div>
            <div class="card-body">
                <ul class="list-unstyled">
                    {% for leave in recent_leave_requests %}
                    <li>
                        {{ leave.employee.full_name }} - {{ leave.leave_type }}
                        <small class="text-muted d-block">{{ leave.start_date|date:"F d, Y" }} to {{ leave.end_date|date:"F d, Y" }}</small>
                    </li>
                    {% empty %}
                    <li>No recent leave requests.</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <!-- Upcoming Trainings -->
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header">Upcoming Trainings</div>
            <div class="card-body">
                <ul class="list-unstyled">
                    {% for training in upcoming_trainings_list %}
                    <li>
                        {{ training.title }}
                        <small class="text-muted d-block">{{ training.start_date|date:"F d, Y" }} - {{ training.participants.count }} participants</small>
                    </li>
                    {% empty %}
                    <li>No upcoming trainings.</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <!-- Recent Performance Reviews -->
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header">Recent Performance Reviews</div>
            <div class="card-body">
                <ul class="list-unstyled">
                    {% for review in recent_performance_reviews %}
                    <li>
                        {{ review.employee.full_name }} - {{ review.review_type }}
                        <small class="text-muted d-block">Reviewed on: {{ review.review_date|date:"F d, Y" }}</small>
                    </li>
                    {% empty %}
                    <li>No recent performance reviews.</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <!-- Recent Payroll Entries -->
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header">Recent Payroll Entries</div>
            <div class="card-body">
                <ul class="list-unstyled">
                    {% for payroll in recent_payroll_entries %}
                    <li>
                        {{ payroll.employee.full_name }} - ${{ payroll.net_salary }}
                        <small class="text-muted d-block">Pay period: {{ payroll.pay_period_start|date:"F d" }} - {{ payroll.pay_period_end|date:"F d, Y" }}</small>
                    </li>
                    {% empty %}
                    <li>No recent payroll entries.</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}